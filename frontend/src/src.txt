==== /home/ikemh/projetos/my-ecommerce/frontend/src/app/layout.js ====
// src/app/layout.js
import { Geist, Geist_Mono, Roboto } from "next/font/google";
import "./globals.css";
import { CartProvider } from "@/context/CartContext";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

const roboto = Roboto({
  subsets: ["latin"],
  weight: ["400", "700"],
  variable: "--font-roboto",
  display: "swap",
});

export const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} ${roboto.variable} font-roboto antialiased`}
      >
        <CartProvider>{children}</CartProvider>
      </body>
    </html>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/app/page.js ====
// src/app/page.js
"use client";

import React, { useState } from "react";
import useCategories from "@/hooks/useCategories";
import NavBar from "@/components/NavBar";
import SideDrawer from "@/components/SideDrawer";
import CartDrawer from "@/components/CartDrawer";
import CategoryTitle from "@/components/CategoryCarousel/CategoryTitle";
import ProductsSection from "@/components/ProductsSection";
import FloatingCheckoutButton from "@/components/FloatingCheckoutButton";

export default function HomePage() {
  const { categories, selectedCategory, setSelectedCategory } = useCategories();
  const [isSideOpen, setIsSideOpen] = useState(false);
  const [isCartOpen, setIsCartOpen] = useState(false);

  const toggleSide = () => {
    // se estamos abrindo o side e o cart est√° aberto no mobile, fecha o cart
    if (
      !isSideOpen &&
      isCartOpen &&
      typeof window !== "undefined" &&
      window.innerWidth < 768
    ) {
      setIsCartOpen(false);
    }
    setIsSideOpen((open) => !open);
  };

  const toggleCart = () => {
    // se estamos abrindo o cart e o side est√° aberto no mobile, fecha o side
    if (
      !isCartOpen &&
      isSideOpen &&
      typeof window !== "undefined" &&
      window.innerWidth < 768
    ) {
      setIsSideOpen(false);
    }
    setIsCartOpen((open) => !open);
  };

  return (
    <div className="min-h-screen bg-[#202020] text-white pt-16">
      <NavBar onToggleDrawer={toggleSide} onToggleCart={toggleCart} />
      <SideDrawer
        isOpen={isSideOpen}
        onClose={() => setIsSideOpen(false)}
        categories={categories}
        selectedCategory={selectedCategory}
        setSelectedCategory={setSelectedCategory}
      />
      <CartDrawer isOpen={isCartOpen} onClose={() => setIsCartOpen(false)} />
      {/* Carrossel full-width, fora do padding do main */}
      <div className="w-full">
        <CategoryTitle
          categories={categories}
          selectedCategory={selectedCategory}
          onSelectCategory={setSelectedCategory}
        />
      </div>
      <main className="max-w-6xl mx-auto space-y-12 p-2 sm:p-6">
        <ProductsSection selectedCategory={selectedCategory} />
      </main>
      <FloatingCheckoutButton />
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/app/checkout/page.jsx ====
"use client";
import React, { useState } from "react";
import { useCart } from "@/context/CartContext";
import { useRouter } from "next/navigation";
import CheckoutLayout from "@/components/CheckoutLayout/CheckoutLayout";

const API_URL = process.env.NEXT_PUBLIC_STRAPI_API;

export default function CheckoutPage() {
  // estado e hooks
  const { items, clearCart } = useCart();
  const [customer, setCustomer] = useState("");
  const [email, setEmail] = useState("");
  const [phone, setPhone] = useState("");
  const [loading, setLoading] = useState(false);
  const router = useRouter();

  // c√°lculo de total
  const total = items.reduce((sum, i) => sum + i.price * i.quantity, 0);

  // handler de submit
  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!customer || !phone || items.length === 0) return;
    setLoading(true);

    try {
      const res = await fetch(`${API_URL}/orders`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ customer, phone, items, total }),
      });
      if (!res.ok) throw new Error();
      clearCart();
      router.push("/success");
    } catch {
      alert("Falha ao enviar pedido.");
    } finally {
      setLoading(false);
    }
  };

  return (
    <CheckoutLayout
      items={items}
      total={total}
      customer={customer}
      email={email}
      phone={phone}
      loading={loading}
      onCustomerChange={setCustomer}
      onEmailChange={setEmail}
      onPhoneChange={setPhone}
      onSubmit={handleSubmit}
    />
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/app/success/page.jsx ====
export default function SuccessPage() {
  return (
    <div className="min-h-screen flex flex-col items-center justify-center text-white bg-[#202020]">
      <h1 className="text-3xl mb-4">Pedido enviado com sucesso!</h1>
      <p>Em breve entraremos em contato via WhatsApp.</p>
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/app/api/checkout/route.js ====
// src/app/api/checkout/route.js
import { NextResponse } from "next/server";

export async function POST(request) {
  try {
    const body = await request.json();

    // 1. Cria o pedido no Strapi (sem order_items)
    const orderRes = await fetch(
      `${process.env.NEXT_PUBLIC_API_URL}/api/orders`,
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: `Bearer ${process.env.STRAPI_API_TOKEN}`,
        },
        body: JSON.stringify({
          data: {
            customer: body.customer,
            email: body.email,
            phone: body.phone,
            cep: body.cep,
            street: body.street,
            neighborhood: body.neighborhood,
            city: body.city,
            state: body.state,
            number: body.number,
            complement: body.complement,
          },
        }),
      }
    );

    const orderData = await orderRes.json();
    if (!orderRes.ok) {
      console.error("Erro ao criar pedido:", orderData);
      return NextResponse.json(orderData, { status: orderRes.status });
    }

    const orderId = orderData.data.id;
    console.log("Pedido criado com sucesso! ID:", orderId);

    // 2. Cria os order-items vinculando ao pedido
    // 2. Cria os order-items vinculando ao pedido
    const items = body.items?.create ?? []; // Acesse corretamente os itens dentro de 'create'

    if (items.length === 0) {
      console.error("Nenhum item encontrado para o pedido.");
      return NextResponse.json(
        { message: "Nenhum item encontrado para o pedido." },
        { status: 400 }
      );
    }

    // Vamos criar os order-items agora
    for (const item of items) {
      const resItem = await fetch(
        `${process.env.NEXT_PUBLIC_API_URL}/api/order-items`,
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${process.env.STRAPI_API_TOKEN}`,
          },
          body: JSON.stringify({
            data: {
              order: orderId, // Associando ao pedido criado
              produto: item.produto, // Produto do item
              quantity: item.quantity, // Quantidade
              unit_price: item.unit_price, // Pre√ßo unit√°rio
            },
          }),
        }
      );

      const itemData = await resItem.json();

      if (!resItem.ok) {
        console.error("Erro ao criar item:", itemData);
        return NextResponse.json(
          { message: itemData.message || "Erro ao criar item." },
          { status: 400 }
        );
      }

      console.log("Item criado com sucesso!", itemData);
    }

    return NextResponse.json({ id: orderId }, { status: 201 });
  } catch (err) {
    console.error("Erro interno:", err);
    return NextResponse.json({ message: err.message }, { status: 500 });
  }
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/ProductsSection.jsx ====
"use client";
import React from "react";
import useProducts from "@/hooks/useProducts";
import ProductCard from "./ProductCard/ProductCard";
import { ArrowBigUpDash } from "lucide-react";

export default function ProductsSection({ selectedCategory }) {
  const { products, lastRef, isValidating, isReachingEnd, error } =
    useProducts(selectedCategory);

  const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  };

  return (
    <section className="bg-[#252525] bg-opacity-90 backdrop-blur-sm rounded-xl p-2 sm:p-6 shadow-lg">
      <div className="grid grid-cols-1 [@media_(min-width:857px)]:grid-cols-2 gap-6">
        {products.map((product, idx) => (
          <ProductCard
            key={product.id}
            product={product}
            observeRef={idx === products.length - 1 ? lastRef : null}
          />
        ))}
      </div>

      {isValidating && (
        <p className="text-center text-gray-500 mt-20 h-[50vh] text-6xl select-none">
          ‚ü≥
        </p>
      )}

      {isReachingEnd && !isValidating && (
        <button
          onClick={scrollToTop}
          aria-label="Voltar ao topo"
          className="flex items-center cursor-pointer h-[100%] justify-center mt-8 mx-auto border rounded-lg p-2 text-gray-500 select-none"
        >
          <span className="text-base font-bold text-lg mr-1">
            Voltar ao topo
          </span>
          <ArrowBigUpDash className="h-6 w-6" />
        </button>
      )}

      {error && (
        <p className="text-red-400 text-center mt-20 h-[50vh] text-2xl select-none cursor-pointer">
          Oops, algo deu errado.
        </p>
      )}
    </section>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CategoriesNav.jsx ====
"use client";
import React from "react";

export default function CategoriesNav({
  categories,
  selectedCategory,
  onSelectCategory,
}) {
  return (
    <nav className="hidden md:block fixed top-1/3 right-6 bg-[#1A1A1A] bg-opacity-80 p-4 rounded-lg shadow-lg z-50">
      <ul className="space-y-2">
        {categories.map((cat) => (
          <li key={cat}>
            <button
              onClick={() => onSelectCategory(cat)}
              className={`text-sm ${
                cat === selectedCategory
                  ? "text-white font-bold"
                  : "text-[#B3B3B3] hover:text-white"
              }`}
            >
              {cat}
            </button>
          </li>
        ))}
      </ul>
    </nav>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/NavBar.jsx ====
// src/components/NavBar.jsx
"use client";
import React from "react";
import { Sidebar, ShoppingCart } from "lucide-react";
import { useCart } from "@/context/CartContext";

export default function NavBar({ onToggleDrawer, onToggleCart }) {
  const { items } = useCart();
  // soma todas as quantidades
  const totalQuantity = items.reduce((sum, item) => sum + item.quantity, 0);

  return (
    <header className="fixed top-0 left-0 right-0 grid grid-cols-12 items-center bg-[#1A1A1A]/80 backdrop-blur-lg border-b border-white/20 px-4 z-50 select-none">
      {/* √çndice */}
      <div className="col-span-3 h-[100%]">
        <button
          onClick={onToggleDrawer}
          aria-label="Abrir menu"
          className="flex items-center cursor-pointer h-[100%] pr-[2rem]"
        >
          <Sidebar className="h-6 w-6" />
          <span className="ml-2 text-xs md:text-base font-bold">√çndice</span>
        </button>
      </div>

      {/* Logo */}
      <div className="col-span-6 text-center">
        <img
          src="/logo.png"
          alt="Logo do site"
          className="h-14 w-auto inline-block"
        />
      </div>

      {/* Carrinho */}
      <div className="col-span-3 flex justify-end h-[100%]">
        <button
          onClick={onToggleCart}
          aria-label="Ver carrinho"
          className="relative flex items-center cursor-pointer h-[100%] pl-[4rem] py-6"
        >
          <span className="hidden md:inline mr-2 text-base font-bold">
            Carrinho
          </span>
          <div className="relative">
            <ShoppingCart className="h-6 w-6 text-white" />
            {totalQuantity > 0 && (
              <span
                className="
                absolute -top-3 -right-2
                bg-[#B8860B] text-white text-xs font-bold
                rounded-full w-5 h-5 flex items-center justify-center
              "
              >
                {totalQuantity}
              </span>
            )}
          </div>
        </button>
      </div>
    </header>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/SideDrawer.jsx ====
// SideDrawer.jsx
"use client";
import React from "react";
import SimpleBar from "simplebar-react";
import "simplebar-react/dist/simplebar.min.css";

export default function SideDrawer({
  isOpen,
  onClose,
  categories,
  selectedCategory,
  setSelectedCategory,
}) {
  return (
    <div
      className={`fixed top-16 left-0 right-0 bottom-0 z-40 ${
        isOpen ? "" : "pointer-events-none"
      }`}
      onClick={onClose}
    >
      <aside
        onClick={(e) => e.stopPropagation()}
        className={`
          fixed top-16 left-0
          h-[calc(100%)]
          w-55
          bg-[#2A2A2A]/95 backdrop-blur-lg
          border-r border-white/20
          origin-left transform transition-all duration-300
          ${isOpen ? "scale-x-100" : "scale-x-0"}
        `}
      >
        <button
          onClick={onClose}
          aria-label="Fechar menu"
          className="cursor-pointer absolute top-[0.2rem] right-2 text-white text-2xl focus:outline-none"
        >
          √ó
        </button>

        <SimpleBar
          style={{ maxHeight: "100%" }}
          className="mt-8 px-4 pl-0 pb-40 scroll-smooth font-roboto"
        >
          <nav className="space-y-1">
            {categories.map((cat) => (
              <button
                key={cat}
                onClick={() => {
                  setSelectedCategory(cat);
                  onClose();
                }}
                className={`
                  w-full text-left py-2 px-3
                  cursor-pointer
                  border-b border-[#60606050] last:border-none
                  transition-transform duration-200
                  ${
                    cat === selectedCategory
                      ? "bg-[#B8860B] font-semibold text-white"
                      : "text-[#D3D3D3] hover:text-white hover:translate-x-2"
                  }
                `}
              >
                {cat}
              </button>
            ))}
          </nav>
        </SimpleBar>
      </aside>
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/FullHoverZoom.jsx ====
"use client";
import React, { useState, useRef } from "react";
import Image from "next/image";

export default function FullHoverZoom({ src, alt, zoom = 2 }) {
  const [zoomed, setZoomed] = useState(false);
  const [origin, setOrigin] = useState({ x: 50, y: 50 });
  const containerRef = useRef(null);

  const handleMouseMove = (e) => {
    const rect = containerRef.current.getBoundingClientRect();
    const x = ((e.clientX - rect.left) / rect.width) * 100;
    const y = ((e.clientY - rect.top) / rect.height) * 100;
    setOrigin({ x, y });
  };

  return (
    <div
      ref={containerRef}
      className="relative w-full aspect-[1000/400] overflow-hidden cursor-zoom-in rounded-lg"
      onMouseEnter={() => setZoomed(true)}
      onMouseMove={(e) => zoomed && handleMouseMove(e)}
      onMouseLeave={() => setZoomed(false)}
    >
      <Image
        src={src}
        alt={alt}
        fill
        className="object-cover rounded-lg"
        style={{
          transform: zoomed ? `scale(${zoom})` : "scale(1)",
          transformOrigin: `${origin.x}% ${origin.y}%`,
          transition: "transform 1s ease",
        }}
      />
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/ProductCard/ProductCard.jsx ====
// src/components/ProductCard/ProductCard.jsx
"use client";

import React, { useState } from "react";
import ImageZoom from "./ImageZoom";
import VariantsTable from "./VariantsTable";
import AddToCartButton from "./AddToCartButton";
import { useCart } from "@/context/CartContext";

export default function ProductCard({ product, observeRef }) {
  const [selectedVariants, setSelectedVariants] = useState([]);
  const [quantities, setQuantities] = useState(() =>
    product.variants.reduce((acc, v) => ({ ...acc, [v.sku]: 0 }), {})
  );
  const { addItem } = useCart();

  const toggleVariant = (sku) =>
    setSelectedVariants((prev) =>
      prev.includes(sku) ? prev.filter((s) => s !== sku) : [...prev, sku]
    );

  const changeQuantity = (sku, val) =>
    setQuantities((prev) => ({ ...prev, [sku]: val }));

  const handleAddToCart = () => {
    selectedVariants.forEach((sku) => {
      const qty = quantities[sku];
      if (qty <= 0) return;
      const variant = product.variants.find((v) => v.sku === sku);
      addItem({
        id: product.id,
        sku,
        title: product.title,
        price: variant.price,
        quantity: qty,
        image: product.imageUrl,
        material: variant.material,
      });
    });

    setSelectedVariants([]);
  };

  const isDisabled =
    selectedVariants.filter((sku) => quantities[sku] > 0).length === 0;

  return (
    <div
      ref={observeRef}
      className="
        select-none bg-[#1F1F1F] border border-[#3A3A3A] rounded-2xl shadow-lg
        w-full max-w-full sm:max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl
        mx-auto p-3 sm:p-6 flex flex-col gap-2 sm:gap-3
      "
    >
      {product.imageUrl && (
        <ImageZoom src={product.imageUrl} alt={product.title} zoom={2} />
      )}

      <h2 className="text-base sm:text-xl font-semibold text-white text-center whitespace-nowrap">
        {product.title}
      </h2>

      <VariantsTable
        variants={product.variants}
        selectedVariants={selectedVariants}
        toggleVariant={toggleVariant}
        quantities={quantities}
        changeQuantity={changeQuantity}
      />

      <AddToCartButton onClick={handleAddToCart} disabled={isDisabled} />
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/ProductCard/ImageZoom.jsx ====
"use client";
import React from "react";
import { PhotoProvider, PhotoView } from "react-photo-view";
import "react-photo-view/dist/react-photo-view.css";
import FullHoverZoom from "../FullHoverZoom";
import ZoomToolbar from "./ZoomToolbar";

export default function ImageZoom({ src, alt, zoom }) {
  return (
    <PhotoProvider
      maskOpacity={0.3}
      maskClassName="bg-black bg-opacity-30 backdrop-blur-sm"
      toolbarRender={ZoomToolbar}
    >
      <PhotoView src={src} key={src}>
        <div className="cursor-zoom-in">
          <FullHoverZoom src={src} alt={alt} zoom={zoom} />
        </div>
      </PhotoView>
    </PhotoProvider>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/ProductCard/ZoomToolbar.jsx ====
import React from "react";

export default function ZoomToolbar({ scale, onScale, onClose }) {
  return (
    <div
      className="
      fixed bottom-8
      left-1/2 transform -translate-x-1/2
      flex space-x-2 md:space-x-4 z-50
    "
    >
      <button
        onClick={() => onScale(scale - 0.2)}
        className="
          w-12 h-12
          bg-[#000000] hover:bg-[#303030]
          text-white text-base text-lg
          rounded-full shadow-md
        "
      >
        ‚àí
      </button>
      <button
        onClick={() => onScale(scale + 0.2)}
        className="
          w-12 h-12
          bg-[#000000] hover:bg-[#303030]
          text-white text-base text-lg
          rounded-full shadow-md
        "
      >
        +
      </button>
      <button
        onClick={onClose}
        className="
          w-12 h-12
          bg-red-400 hover:bg-red-500
          text-white text-base text-lg
          rounded-full shadow-md
        "
      >
        √ó
      </button>
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/ProductCard/VariantsTable.jsx ====
import React from "react";
import VariantRow from "./VariantRow";

export default function VariantsTable({
  variants,
  selectedVariants,
  toggleVariant,
  quantities,
  changeQuantity,
}) {
  return (
    <div className="overflow-hidden rounded-lg border border-[#3A3A3A]">
      <table
        className="
          w-full
          text-[#B3B3B3]
          table-auto
          border-separate border-spacing-0
        "
      >
        <thead className="bg-[#2A2A2A]">
          <tr>
            <th className="w-[5%] px-2 py-0 text-center text-md font-bold" />
            <th className="w-[40%] px-2 py-0 text-left text-md font-bold">
              Material
            </th>
            <th className="w-[25%] px-2 py-0 text-left text-md font-bold">
              Pre√ßo
            </th>
            <th className="w-[20%] px-2 py-0 text-center text-md font-bold">
              Qtde.
            </th>
          </tr>
        </thead>
        <tbody>
          {variants.map((v, i) => (
            <VariantRow
              key={v.sku}
              variant={v}
              checked={selectedVariants.includes(v.sku)}
              toggle={() => toggleVariant(v.sku)}
              quantity={quantities[v.sku]}
              onQuantityChange={(val) => changeQuantity(v.sku, val)}
              // adiciona classes especiais no √∫ltimo row para garantir os cantos
              className={`
                ${i % 2 === 0 ? "bg-[#1E1E1E]" : ""}
                ${i === variants.length - 1 ? "last:rounded-bl-lg last:rounded-br-lg" : ""}
              `}
            />
          ))}
        </tbody>
      </table>
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/ProductCard/VariantRow.jsx ====
// src/components/ProductCard/VariantRow.jsx
import React from "react";

export default function VariantRow({
  variant,
  checked,
  toggle,
  quantity,
  onQuantityChange,
}) {
  const handleQtyChange = (raw) => {
    // s√≥ d√≠gitos, at√© 3 chars
    const digits = String(raw).replace(/\D/g, "").slice(0, 3);
    // remove zeros √† esquerda, mas deixa "0" se tudo for zero
    const clean = digits.replace(/^0+/, "") || "0";
    const num = Math.min(999, parseInt(clean, 10));
    onQuantityChange(num);
    // auto-toggle checkbox
    if (num > 0 && !checked) toggle();
    if (num === 0 && checked) toggle();
  };

  const decrement = () => handleQtyChange(quantity - 1);
  const increment = () => handleQtyChange(quantity + 1);
  const handleInput = (e) => handleQtyChange(e.target.value);

  // ajusta font-size conforme d√≠gitos
  const len = String(quantity).length;
  const fontSize = len === 1 ? "1rem" : len === 2 ? "0.9rem" : "0.8rem";

  return (
    <tr className="odd:bg-transparent even:bg-[#272727]">
      {/* Checkbox */}
      <td className="w-[10%] pt-2 pb-0 border-t border-[#2A2A2A] text-center">
        <input
          type="checkbox"
          checked={checked}
          onChange={toggle}
          className="h-6 w-6 accent-yellow-400 bg-[#1A1A1A] border border-[#2A2A2A] rounded"
        />
      </td>

      {/* Material */}
      <td className="w-[45%] px-2 py-0 border-t border-[#2A2A2A] text-left font-bold">
        {variant.material}
      </td>

      {/* Pre√ßo */}
      <td className="w-[20%] px-2 py-0 border-t border-[#2A2A2A] text-left text-[#DFDFDF] font-bold">
        R$ {variant.price.toFixed(2)}
      </td>

      {/* Quantidade */}
      <td className="w-[25%] px-2 py-0 border-t border-[#2A2A2A] text-center">
        <div className="inline-flex items-center border border-[#2A2A2A] bg-[#1A1A1A] rounded">
          <button
            type="button"
            onClick={decrement}
            disabled={quantity <= 0}
            className="
              h-6 w-6 flex items-center justify-center
              text-white font-bold
              border-r border-[#2A2A2A]
              disabled:opacity-50 disabled:hover:bg-[#1A1A1A]
              hover:bg-[#272727]
            "
          >
            ‚Äì
          </button>

          <input
            type="text"
            inputMode="numeric"
            pattern="\d*"
            value={quantity}
            onChange={handleInput}
            maxLength={3}
            style={{ fontSize }}
            className={
              `w-8 h-6 bg-transparent text-center font-mono p-0 focus:outline-none focus:ring-2 focus:ring-yellow-400 ` +
              (quantity > 0 ? "text-[#DADADA]" : "text-[gray]/50")
            }
          />

          <button
            type="button"
            onClick={increment}
            disabled={quantity >= 999}
            className="
              h-6 w-6 flex items-center justify-center
              text-white font-bold
              border-l border-[#2A2A2A]
              disabled:opacity-50 disabled:cursor-not-allowed
              hover:bg-[#272727]
            "
          >
            +
          </button>
        </div>
      </td>
    </tr>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/ProductCard/AddToCartButton.jsx ====
"use client";

import React, { useState } from "react";
import { ShoppingCart } from "lucide-react";
import CartChangeToast from "../CartChangeToast";

export default function AddToCartButton({ onClick, disabled }) {
  const [toast, setToast] = useState(null);

  const handleClick = () => {
    if (onClick) onClick();
    setToast({ message: "Produto adicionado ao carrinho!", type: "success" });
  };

  return (
    <>
      <button
        type="button"
        onClick={handleClick}
        disabled={disabled}
        className={`
          mt-auto py-2 sm:py-3 px-3 sm:px-6
          bg-gradient-to-r from-[#D4AF37] to-[#B8860B]
          hover:from-[#CFAF37] hover:to-[#A8760B]
          text-white font-semibold rounded-xl shadow-md
          transition flex items-center justify-center space-x-2
          text-base sm:text-lg
          cursor-pointer disabled:opacity-70
        `}
      >
        <ShoppingCart className="h-5 w-5" />
        <span>Adicionar ao carrinho</span>
      </button>

      {toast && (
        <CartChangeToast
          message={toast.message}
          type={toast.type}
          onClose={() => setToast(null)}
        />
      )}
    </>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CategoryCarousel/CategoryTitle.jsx ====
"use client";
import React, { useEffect, useRef } from "react";
import { Stardos_Stencil } from "next/font/google";
import { Anton } from "next/font/google";

const anton = Anton({ weight: "400", subsets: ["latin"] });
const stencil = Stardos_Stencil({ subsets: ["latin"], weight: "700" });

export default function CategoryTitle({
  categories,
  selectedCategory,
  onSelectCategory,
}) {
  const containerRef = useRef(null);
  const itemsRef = useRef([]);

  useEffect(() => {
    const c = containerRef.current;
    if (!c) return;
    c.style.scrollBehavior = "smooth";
    c.style.msOverflowStyle = "none";
    c.style.scrollbarWidth = "none";
  }, []);

  useEffect(() => {
    const c = containerRef.current;
    const idx = categories.indexOf(selectedCategory);
    const item = itemsRef.current[idx];
    if (c && item) {
      const cr = c.getBoundingClientRect();
      const ir = item.getBoundingClientRect();
      const offset = ir.left - cr.left - (cr.width / 2 - ir.width / 2);
      c.scrollBy({ left: offset, behavior: "smooth" });
    }
  }, [selectedCategory, categories]);

  const handleWheel = (e) => {
    e.preventDefault();
    containerRef.current?.scrollBy({ left: e.deltaY, behavior: "smooth" });
  };

  const handleKeyDown = (e) => {
    const idx = categories.indexOf(selectedCategory);
    if (e.key === "ArrowRight" && idx < categories.length - 1) {
      onSelectCategory(categories[idx + 1]);
    } else if (e.key === "ArrowLeft" && idx > 0) {
      onSelectCategory(categories[idx - 1]);
    }
  };

  return (
    <div className="flex flex-col items-center mt-12 pb-8 select-none">
      {/* T√≠tulo com degrad√™ e contorno */}
      <h2
        className={`text-5xl ${anton.className} uppercase mb-6 pt-3 pb-3 text-[#ddd] tracking-wide text-center`}
        style={{
          textShadow: `
      2px 2px 0 rgba(0,0,0,0.7),
      -1px -1px 0 rgba(255,255,255,0.15),
      0 0 8px rgba(255,255,255,0.2)
    `,
        }}
      >
        CAT√ÅLOGO
        <br />
        <span className="block text-2xl text-[#D4AF37] font-normal tracking-normal leading-tight mt-1">
          2025
        </span>
      </h2>

      <div
        ref={containerRef}
        tabIndex={0}
        onWheel={handleWheel}
        onKeyDown={handleKeyDown}
        className="flex space-x-3 overflow-x-auto w-full px-4"
        style={{
          scrollbarWidth: "none",
          msOverflowStyle: "none",
        }}
      >
        {categories.map((cat, i) => {
          const isActive = cat === selectedCategory;
          return (
            <div
              key={cat}
              ref={(el) => (itemsRef.current[i] = el)}
              className={`relative flex-shrink-0 cursor-pointer transition-all duration-300 rounded-md min-w-[12rem] sm:min-w-[14rem] md:min-w-[15rem] ${
                isActive
                  ? "scale-100 opacity-80"
                  : "scale-95 opacity-70 hover:scale-100 hover:opacity-90"
              }`}
              onClick={() => onSelectCategory(cat)}
            >
              {/* Camada met√°lica com efeito 3D */}
              <div
                className={`absolute inset-0 rounded-md ${
                  isActive ? "brightness-110" : ""
                }`}
                style={{
                  backgroundImage: `
                    linear-gradient(145deg, #d0d0d0, #909090),
                    repeating-linear-gradient(
                      45deg,
                      #c0c0c0 0px,
                      #e0e0e0 2px,
                      #c0c0c0 4px
                    )
                  `,
                  backgroundBlendMode: "overlay",
                  backgroundSize: "cover",
                  boxShadow: `
                    inset 2px 2px 5px rgba(255,255,255,0.3),
                    inset -2px -2px 5px rgba(0,0,0,0.4),
                    2px 2px 8px rgba(0,0,0,0.5)
                  `,
                }}
              />

              {/* Conte√∫do do bot√£o */}
              <div
                className={`relative z-10 px-6 py-3 text-center rounded-md border transition-all duration-200 ${
                  isActive
                    ? "border-[#D4AF37] border-2 shadow-[0_0_10px_rgba(255,255,255,0.3)]"
                    : "border-[#fafafa]"
                } hover:shadow-[0_0_8px_rgba(255,255,255,0.2)] border-2`}
              >
                <h2
                  className={`${stencil.className} text-base sm:text-lg md:text-xl uppercase font-extrabold text-transparent bg-clip-text`}
                  style={{
                    backgroundImage: `
                      repeating-linear-gradient(
                        135deg,
                        #a0a0a0 0px,
                        #d0d0d0 1px,
                        #a0a0a0 2px
                      ),
                      linear-gradient(135deg, rgba(2, 2, 2, 0.5), rgba(0,0,0,0.1))
                    `,
                    backgroundBlendMode: "overlay",
                    backgroundSize: "100% 2px, 200% 200%",
                  }}
                >
                  {cat}
                </h2>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/NotificationDialog.jsx ====
// src/components/NotificationDialog.jsx
"use client";

import React from "react";
import { createPortal } from "react-dom";
import { X } from "lucide-react";

export default function NotificationDialog({ notifications, clear }) {
  if (!notifications.length) return null;

  return createPortal(
    <div className="fixed bottom-20 w-80 left-1/2 transform -translate-x-1/2 z-50">
      <div className="max-w-md bg-[#1A1A1A]/70 backdrop-blur-lg text-white rounded-lg border border-white/20 shadow-lg overflow-hidden">
        {/* Cabe√ßalho fixo */}
        <div className="flex items-center justify-between px-4 py-2 border-b border-white/20">
          <span className="text-[1rem] font-semibold">
            ‚ö†Ô∏è &nbsp;Pedido M√≠nimo
          </span>
          <button onClick={clear} aria-label="Fechar" className="p-1">
            <X className="cursor-pointer h-6 w-6" />
          </button>
        </div>

        {/* Lista completa sempre vis√≠vel */}
        <div className="px-4 py-2 space-y-1 text-xs">
          {notifications.map((n, index) => (
            <div key={`${n.id}-${index}`} className="flex items-start">
              <span className="mr-2">‚Ä¢</span>
              <span className="flex-1">{n.text}</span>
            </div>
          ))}
          <div className="mt-2 text-yellow-300">
            * Apenas o material conta. Modelo n√£o interfere.
          </div>
        </div>
      </div>
    </div>,
    document.body
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/FloatingCheckoutButton.jsx ====
// src/components/FloatingCheckoutButton.jsx
"use client";

import React, { useEffect, useState } from "react";
import { useRouter } from "next/navigation";
import { useCart } from "@/context/CartContext";
import { useNotifications } from "@/hooks/useNotifications";
import NotificationDialog from "./NotificationDialog";

export default function FloatingCheckoutButton() {
  const router = useRouter();
  const { items } = useCart();
  const {
    list: notifications,
    add: addNotification,
    clear: clearNotifications,
  } = useNotifications(7);

  // Visibilidade do bot√£o
  const [visible, setVisible] = useState(false);
  useEffect(() => {
    setVisible(items.length > 0);
  }, [items.length]);

  // Agrupa quantidade por material (usado na valida√ß√£o)
  const totalsByMaterial = items.reduce((acc, item) => {
    acc[item.material] = (acc[item.material] || 0) + item.quantity;
    return acc;
  }, {});

  const handleCheckout = () => {
    clearNotifications();

    const shortages = Object.entries(totalsByMaterial)
      .filter(([_, qty]) => qty < 5)
      .map(([material, qty]) => ({ material, missing: 5 - qty }));

    if (shortages.length === 0) {
      router.push("/checkout");
    } else {
      shortages.forEach(({ material, missing }) =>
        addNotification(
          <>
            <div className="text-[0.9rem]">
              <span className="text-[#dadada]">
                Falta{missing > 1 ? "m" : ""}
              </span>{" "}
              <span className="font-bold">{missing}</span>{" "}
              <span className="text-[#dadada]">
                unidade
                {missing > 1 ? "s" : ""} de
              </span>{" "}
              <span className="font-bold">{material}</span>
            </div>
          </>
        )
      );
    }
  };

  useEffect(() => {
    if (notifications.length > 0) {
      clearNotifications();

      const shortages = Object.entries(totalsByMaterial)
        .filter(([_, qty]) => qty < 5)
        .map(([material, qty]) => ({ material, missing: 5 - qty }));

      shortages.forEach(({ material, missing }) =>
        addNotification(
          <>
            <div className="text-[0.9rem]">
              <span className="text-[#dadada]">
                Falta{missing > 1 ? "m" : ""}
              </span>{" "}
              <span className="font-bold">{missing}</span>{" "}
              <span className="text-[#dadada]">
                unidade
                {missing > 1 ? "s" : ""} de
              </span>{" "}
              <span className="font-bold">{material}</span>
            </div>
          </>
        )
      );
    }
  }, [items, clearNotifications, addNotification, notifications.length]);

  return (
    <>
      <div
        className={`
          fixed bottom-0 left-0 right-0
          grid grid-cols-12 items-center
          bg-[#1A1A1A]/80 backdrop-blur-lg
          border-t border-white/20
          px-4 py-3 z-50
          transform transition-transform duration-500 ease-out
          ${visible ? "translate-y-0" : "translate-y-full"}
        `}
      >
        <div className="col-span-12 flex justify-center select-none">
          <button
            onClick={handleCheckout}
            className="
              bg-gradient-to-r from-[#D4AF37] to-[#B8860B]
              hover:from-[#CFAF37] hover:to-[#A8760B]
              text-white text-lg font-semibold
              py-2 px-6 rounded-xl
              cursor-pointer
              shadow-[0_4px_0_#B8860B] hover:shadow-[0_2px_0_#A8760B]
              transform transition-all duration-200
              hover:-translate-y-1 active:translate-y-1 active:scale-95
            "
            aria-label="Finalizar Pedido"
          >
            üî™ Finalizar Pedido!
          </button>
        </div>
      </div>

      <NotificationDialog
        notifications={notifications}
        clear={clearNotifications}
      />
    </>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CartDrawer.jsx ====
"use client";

import React, { useState } from "react";
import { useRouter } from "next/navigation";
import SimpleBar from "simplebar-react";
import "simplebar-react/dist/simplebar.min.css";
import { X } from "lucide-react";
import { useCart } from "@/context/CartContext";
import CartChangeToast from "./CartChangeToast";

export default function CartDrawer({ isOpen, onClose }) {
  const router = useRouter();
  const { items, removeItem } = useCart();
  const [toast, setToast] = useState(null);

  // calcula subtotal
  const subtotal = items.reduce((sum, i) => sum + i.price * i.quantity, 0);

  const handleRemove = (sku) => {
    removeItem(sku);
    setToast({ message: "Produto removido do carrinho!", type: "error" });
  };

  return (
    <div
      className={`z-40 fixed inset-0 ${isOpen ? "" : "pointer-events-none"}`}
      onClick={onClose}
    >
      <style jsx global>{`
        .cart-scrollbar .simplebar-track.simplebar-vertical {
          right: auto !important;
          left: 0 !important;
        }
      `}</style>

      <aside
        onClick={(e) => e.stopPropagation()}
        className={`
          fixed top-16 right-0
          h-[100%] w-65
          bg-[#2A2A2A]/95 backdrop-blur-lg
          border-l border-white/20
          origin-right transform transition-transform duration-300
          ${isOpen ? "translate-x-0" : "translate-x-full"}
        `}
      >
        {/* Bot√£o de fechar */}
        <button
          onClick={onClose}
          aria-label="Fechar carrinho"
          className="z-50 cursor-pointer absolute top-[0.2rem] left-2 text-white text-2xl focus:outline-none"
        >
          √ó
        </button>

        {/* Conte√∫do rol√°vel com classe espec√≠fica */}
        <SimpleBar
          style={{ maxHeight: "100%" }}
          className="mt-8 pb-60 pl-1 cart-scrollbar"
        >
          {items.length === 0 ? (
            <p className="pl-8 pt-2 text-xl text-[#B3B3B3]">Carrinho vazio.</p>
          ) : (
            <ul>
              {items.map((i, idx) => (
                <li
                  key={i.sku}
                  className={`
                    flex items-center justify-between px-4 py-3
                    border-b border-[#60606070]
                    ${idx === items.length - 1 ? "border-none" : ""}
                  `}
                >
                  <img
                    src={i.image}
                    alt={i.title}
                    className="h-8 w-auto object-contain rounded"
                  />
                  <div className="flex-1 ml-3">
                    <div className="font-semibold text-[1em] text-white">
                      {i.title}
                    </div>
                    <div className="text-[0.8rem] text-[#DADADA]">
                      {i.material}
                    </div>
                    <div className="text-[0.9rem] text-white mt-1">
                      x{i.quantity} ¬∑ R$ {(i.price * i.quantity).toFixed(2)}
                    </div>
                  </div>
                  <button
                    onClick={() => handleRemove(i.sku)}
                    aria-label="Remover item"
                    className="ml-2 text-red-400 hover:text-red-400/60 p-1 cursor-pointer"
                  >
                    <X className="h-4 w-4" />
                  </button>
                </li>
              ))}
            </ul>
          )}
        </SimpleBar>

        {items.length > 0 && (
          <div className="fixed pb-[9rem] bottom-0 left-0 w-full p-4 bg-[#1A1A1A]/90 backdrop-blur-md z-60 border-t border-white/20">
            <div className="flex justify-between items-center text-base font-semibold text-white">
              <span>Subtotal:</span>
              <span>R$ {subtotal.toFixed(2)}</span>
            </div>
          </div>
        )}
      </aside>

      {toast && (
        <CartChangeToast
          message={toast.message}
          type={toast.type}
          onClose={() => setToast(null)}
        />
      )}
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CartChangeToast.jsx ====
// src/components/CartChangeToast.jsx
"use client";

import React, { useEffect } from "react";
import { createPortal } from "react-dom";

export default function CartChangeToast({
  message,
  type = "success",
  onClose,
}) {
  // fecha automaticamente ap√≥s 2s
  useEffect(() => {
    const t = setTimeout(onClose, 2000);
    return () => clearTimeout(t);
  }, [onClose]);

  // cores suaves
  const bgClass =
    type === "success"
      ? "bg-[#2A2A2A]/95 backdrop-blur-lg border-green-100 text-green-500"
      : "bg-[#2A2A2A]/95 backdrop-blur-lg   border-red-100   text-red-500";

  return createPortal(
    <div className="fixed top-20 w-80 left-1/2 transform -translate-x-1/2 z-50">
      <div
        className={`
          max-w-md
          ${bgClass}
          backdrop-blur-lg
          rounded-lg
          border
          px-4 py-2
          shadow-lg
          text-center
          font-medium
        `}
      >
        {message}
      </div>
    </div>,
    document.body
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CheckoutLayout/CheckoutLayout.jsx ====
// src/components/CheckoutLayout.jsx
// Esqueleto de layout que comp√µe ProductSummary + CustomerInfoForm

"use client";
import React from "react";
import Link from "next/link";
import { ArrowLeft } from "lucide-react";
import ProductSummary from "./ProductSummary";
import CustomerInfoForm from "./CustomerInfoForm";

export default function CheckoutLayout({
  items,
  total,
  customer,
  email,
  phone,
  loading,
  onCustomerChange,
  onEmailChange,
  onPhoneChange,
  onSubmit,
}) {
  return (
    <div className="min-h-screen bg-[#202020] text-white font-roboto antialiased">
      {/* Header fixo */}
      <header className="fixed top-0 left-0 right-0 px-4 py-3 grid grid-cols-12 items-center bg-[rgba(26,26,26,0.7)] backdrop-blur-lg z-30 border-b border-white/20">
        <div className="col-span-2 flex items-center">
          <Link
            href="/"
            aria-label="Voltar ao cat√°logo"
            className="flex items-center"
          >
            <ArrowLeft className="h-6 w-6 text-white mr-1" />
            <span className="text-white text-base font-bold">Cat√°logo</span>
          </Link>
        </div>
        <div className="col-span-8 text-center">
          <img
            src="/logo.png"
            alt="Logo do site"
            className="h-14 w-auto inline-block"
          />
        </div>
      </header>

      {/* Conte√∫do principal */}
      <main className="pt-30 pb-10 px-4 max-w-6xl mx-auto space-y-12 backdrop-blur-sm bg-[#252525] bg-opacity-90 min-h-[100vh] md:w-120">
        <ProductSummary items={items} total={total} />

        <CustomerInfoForm
          customer={customer}
          email={email}
          phone={phone}
          loading={loading}
          disableSubmit={items.length === 0}
          onCustomerChange={onCustomerChange}
          onEmailChange={onEmailChange}
          onPhoneChange={onPhoneChange}
          onSubmit={onSubmit}
        />
      </main>
    </div>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CheckoutLayout/CustomerInfoForm.jsx ====
// src/components/CustomerInfoForm.jsx
"use client";
import React, { useEffect, useRef, useState } from "react";
import Script from "next/script";
import {
  initPhoneInput,
  validatePhoneBR,
} from "@/components/CheckoutLayout/utils/phoneUtils";
import { validateEmail } from "@/components/CheckoutLayout/utils/emailUtils";
import { fetchAddressByCEP } from "@/components/CheckoutLayout/utils/cepUtils";
import { useCart } from "@/context/CartContext";

export default function CustomerInfoForm({
  customer,
  email,
  phone,
  loading,
  disableSubmit,
  onCustomerChange,
  onEmailChange,
  onPhoneChange,
  onSubmit,
}) {
  const { items } = useCart();
  console.log("Itens do carrinho:", items);
  const phoneRef = useRef(null);

  // CEP / Endere√ßo
  const [cep, setCep] = useState("");
  const [address, setAddress] = useState({
    street: "",
    neighborhood: "",
    city: "",
    state: "",
  });
  const [loadingCep, setLoadingCep] = useState(false);

  // N√∫mero e Complemento
  const [number, setNumber] = useState("");
  const [complement, setComplement] = useState("");

  // Inicializa m√°scara de telefone
  useEffect(() => {
    if (!phoneRef.current) return;
    const cleanup = initPhoneInput(phoneRef, onPhoneChange);
    return cleanup;
  }, [onPhoneChange]);

  // Busca endere√ßo automaticamente quando CEP completa 8 d√≠gitos
  useEffect(() => {
    const sanitized = cep.replace(/\D/g, "");
    if (sanitized.length === 8) {
      setLoadingCep(true);
      fetchAddressByCEP(sanitized)
        .then((addr) => setAddress(addr))
        .catch((err) => {
          alert(err.message);
          setAddress({ street: "", neighborhood: "", city: "", state: "" });
        })
        .finally(() => setLoadingCep(false));
    }
  }, [cep]);

  // Valida e envia
  const handleSubmit = async (e) => {
    e.preventDefault();

    if (!items || items.length === 0) {
      console.error("Erro: Nenhum item no carrinho");
      alert("Por favor, adicione itens ao carrinho.");
      return;
    }

    if (!address.street) {
      alert("Por favor, informe um CEP v√°lido para preencher o endere√ßo.");
      return;
    }
    if (!number.trim()) {
      alert("Por favor, informe o N√∫mero.");
      return;
    }

    const emailCheck = validateEmail(email);
    if (!emailCheck.valid) {
      alert(emailCheck.reason);
      return;
    }
    const phoneVal = validatePhoneBR(phoneRef.current.value);
    if (!phoneVal.valid) {
      alert(phoneVal.reason);
      return;
    }
    onPhoneChange(phoneVal.e164);

    const payload = {
      customer,
      email,
      phone: phoneVal.e164,
      cep,
      street: address.street,
      neighborhood: address.neighborhood,
      city: address.city,
      state: address.state,
      number,
      complement,
      order_items: items.map((i) => ({
        produto: i.id,
        quantity: i.quantity,
        unit_price: i.price,
      })),
    };

    console.log("Payload a ser enviado:", payload);

    try {
      const res = await fetch("/api/checkout", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });

      // Corrigir o erro no tratamento da resposta
      if (!res.ok) {
        const error = await res.json(); // Captura a resposta de erro
        console.error("Erro ao enviar o pedido:", error);
        alert(`Erro: ${error.message || "Falha ao criar pedido"}`);
        return;
      }

      const data = await res.json(); // Supondo que a resposta de sucesso contenha o pedido criado
      alert(`Pedido #${data.id} criado com sucesso!`);
    } catch (err) {
      console.error("Erro ao enviar o pedido:", err);
      alert(`Erro: ${err.message}`);
    }
  };

  return (
    <section className="bg-[#1E1E1E] bg-opacity-90 p-6 rounded-2xl border border-[#2A2A2A] shadow-inner">
      <Script
        src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"
        strategy="afterInteractive"
      />
      <h2 className="uppercase tracking-wide text-2xl mb-4 text-[#DDDDDD]">
        Informa√ß√µes
      </h2>
      <form noValidate onSubmit={handleSubmit} className="space-y-6">
        {/* Nome/Empresa */}
        <div>
          <label className="block mb-2 text-sm text-[#DADADA] font-bold after:content-['*'] after:ml-1 after:text-red-500/30">
            Nome/Empresa
          </label>
          <input
            type="text"
            name="name"
            autoComplete="name"
            value={customer}
            onChange={(e) => onCustomerChange(e.target.value)}
            required
            minLength={2}
            placeholder="Jo√£o da Silva / Empresa XYZ"
            className="w-full p-3 rounded-xl bg-[#1A1A1A] border border-[#2A2A2A] focus:ring-2 focus:ring-[#D4AF37] text-white placeholder-gray-400/25"
          />
        </div>

        {/* E-mail */}
        <div>
          <label className="block mb-2 text-sm text-[#DADADA] font-bold after:content-['*'] after:ml-1 after:text-red-500/30">
            E-mail
          </label>
          <input
            type="email"
            name="email"
            autoComplete="email"
            value={email}
            onChange={(e) => onEmailChange(e.target.value)}
            required
            placeholder="joao@gmail.com"
            className="w-full p-3 rounded-xl bg-[#1A1A1A] border border-[#2A2A2A] focus:ring-2 focus:ring-[#D4AF37] text-white placeholder-gray-400/25"
          />
        </div>

        {/* CEP */}
        <div>
          <label className="block mb-2 text-sm text-[#DADADA] font-bold after:content-['*'] after:ml-1 after:text-red-500/30">
            CEP
          </label>
          <input
            type="text"
            name="postal-code"
            autoComplete="postal-code"
            value={cep.replace(/(\d{5})(\d{1,3})?/, (_, p1, p2) =>
              p2 ? `${p1}-${p2}` : p1
            )}
            onChange={(e) =>
              setCep(e.target.value.replace(/\D/g, "").slice(0, 8))
            }
            required
            maxLength={9}
            pattern="[0-9]{5}-[0-9]{3}"
            title="Digite um CEP no formato 00000-000"
            placeholder="00000-000"
            className="w-full p-3 rounded-xl bg-[#1A1A1A] border border-[#2A2A2A] focus:ring-2 focus:ring-[#D4AF37] text-white placeholder-gray-400 placeholder-opacity-25"
          />
        </div>

        {/* Endere√ßo preenchido */}
        {address.street && (
          <>
            <div>
              <label className="block mb-2 text-sm text-[#DADADA] font-bold after:content-['*'] after:ml-1 after:text-red-500/30">
                Rua
              </label>
              <input
                type="text"
                value={address.street}
                readOnly
                className="w-full p-3 rounded-xl bg-[#2A2A2A] border border-[#3A3A3A] text-[#CCCCCC]"
              />
            </div>
            <div>
              <label className="block mb-2 text-sm text-[#DADADA] font-bold after:content-['*'] after:ml-1 after:text-red-500/30">
                Bairro
              </label>
              <input
                type="text"
                value={address.neighborhood}
                readOnly
                className="w-full p-3 rounded-xl bg-[#2A2A2A] border border-[#3A3A3A] text-[#CCCCCC]"
              />
            </div>
            <div className="grid grid-cols-2 gap-4">
              <div>
                <label className="block mb-2 text-sm text-[#DADADA] font-bold after:content-['*'] after:ml-1 after:text-red-500/30">
                  Cidade
                </label>
                <input
                  type="text"
                  value={address.city}
                  readOnly
                  className="w-full p-3 rounded-xl bg-[#2A2A2A] border border-[#3A3A3A] text-[#CCCCCC]"
                />
              </div>
              <div>
                <label className="block mb-2 text-sm text-[#DADADA]">UF</label>
                <input
                  type="text"
                  value={address.state}
                  readOnly
                  className="w-full p-3 rounded-xl bg-[#2A2A2A] border border-[#3A3A3A] text-[#CCCCCC]"
                />
              </div>
            </div>

            {/* N√∫mero */}
            <div>
              <label className="block mb-2 text-sm text-[#DADADA] font-bold after:content-['*'] after:ml-1 after:text-red-500/30">
                N√∫mero
              </label>
              <input
                type="text"
                value={number}
                onChange={(e) => setNumber(e.target.value)}
                required
                placeholder="99"
                className="w-full p-3 rounded-xl bg-[#1A1A1A] border border-[#2A2A2A] focus:ring-2 focus:ring-[#D4AF37] text-white placeholder-gray-400/25"
              />
            </div>

            {/* Complemento */}
            <div>
              <label className="block mb-2 text-sm text-[#DADADA] font-bold">
                Complemento
              </label>
              <input
                type="text"
                value={complement}
                onChange={(e) => setComplement(e.target.value)}
                placeholder="Pavilh√£o Esquina"
                className="w-full p-3 rounded-xl bg-[#1A1A1A] border border-[#2A2A2A] focus:ring-2 focus:ring-[#D4AF37] text-white placeholder-gray-400/25"
              />
            </div>
          </>
        )}

        {/* Celular */}
        <div>
          <label className="block mb-2 text-sm text-[#DADADA] font-bold after:content-['*'] after:ml-1 after:text-red-500/30">
            Celular
          </label>
          <input
            ref={phoneRef}
            type="tel"
            name="tel"
            autoComplete="tel"
            defaultValue={phone}
            required
            placeholder="(00) 00000-0000"
            className="w-full p-3 rounded-xl bg-[#1A1A1A] border border-[#2A2A2A] focus:ring-2 focus:ring-[#D4AF37] text-white placeholder-gray-400/25"
          />
        </div>

        {/* Bot√£o */}
        <button
          type="submit"
          disabled={loading || disableSubmit || loadingCep}
          className="w-full py-3 text-lg font-semibold rounded-xl bg-gradient-to-r from-[#D4AF37] to-[#B8860B] hover:from-[#CFAF37] hover:to-[#A8760B] disabled:opacity-50 cursor-pointer disabled:cursor-not-allowed"
        >
          {loading
            ? "Enviando‚Ä¶"
            : loadingCep
              ? "Buscando CEP‚Ä¶"
              : "Finalizar Pedido"}
        </button>
      </form>
    </section>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CheckoutLayout/ProductSummary.jsx ====
// src/components/ProductSummary.jsx
// Exibe lista de itens, totais e bot√µes de remo√ß√£o

import React from "react";
import { X } from "lucide-react";
import { useCart } from "@/context/CartContext";

export default function ProductSummary({ items, total }) {
  const { removeItem } = useCart();

  return (
    <section>
      <h1 className="uppercase tracking-wide text-3xl mb-6 text-[#DDDDDD] text-center">
        Resumo do Pedido
      </h1>

      {items.length === 0 ? (
        <p className="text-base text-[#AAAAAA]">Seu carrinho est√° vazio.</p>
      ) : (
        <ul>
          {items.map((i, idx) => (
            <li
              key={i.sku}
              className={`flex items-center justify-between p-4 rounded-lg ${
                idx % 2 === 0 ? "bg-[#1E1E1E]" : "bg-[#2A2A2A]"
              }`}
            >
              <img
                src={i.image}
                alt={i.title}
                className="h-12 w-auto object-contain rounded-md"
              />
              <div className="flex-1 ml-4">
                <div className="font-semibold text-base text-white">
                  {i.title}
                </div>
                <div className="text-sm text-[#B3B3B3]">{i.material}</div>
              </div>
              <div className="w-12 text-center text-white font-medium">
                {i.quantity}
              </div>
              <div className="w-24 text-right text-white font-medium">
                R$ {(i.price * i.quantity).toFixed(2)}
              </div>
              <button
                onClick={() => removeItem(i.sku)}
                aria-label="Remover item"
                className="ml-4 text-red-400 hover:text-red-600 p-1"
              >
                <X className="h-5 w-5" />
              </button>
            </li>
          ))}

          <li className="flex justify-between items-center mt-4 pt-4 border-t border-[rgba(255,255,255,0.3)]">
            <span className="font-semibold text-lg text-white">Total</span>
            <span className="font-semibold text-lg text-white">
              R$ {total.toFixed(2)}
            </span>
          </li>
        </ul>
      )}
    </section>
  );
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CheckoutLayout/utils/phoneUtils.js ====
// src/utils/phoneUtils.js
// Gerencia init e valida√ß√£o de telefone (Brasil) usando intl-tel-input + libphonenumber-js

import intlTelInput from "intl-tel-input";
import "intl-tel-input/build/css/intlTelInput.css";
import { parsePhoneNumberFromString } from "libphonenumber-js";

/**
 * Inicializa o campo de telefone com intl-tel-input.
 * @param {{ current: HTMLInputElement }} inputRef
 * @param {(e164: string) => void} onPhoneChange
 * @returns {() => void} fun√ß√£o de limpeza
 */
export function initPhoneInput(inputRef, onPhoneChange) {
  const inputEl = inputRef.current;
  const iti = intlTelInput(inputEl, {
    initialCountry: "br",
    onlyCountries: ["br"],
    separateDialCode: true,
    autoHideDialCode: true,
    allowDropdown: false,
    nationalMode: true,
    utilsScript:
      "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
  });

  // Formata enquanto digita no padr√£o (##) #####-####
  // Formata enquanto digita no padr√£o (##) #####-####
  const formatInput = () => {
    let raw = inputRef.current.value.replace(/\D/g, "");
    if (raw.startsWith("55")) raw = raw.slice(2);
    raw = raw.slice(0, 11);
    const formatted = window.intlTelInputUtils.formatNumber(
      raw,
      "BR",
      window.intlTelInputUtils.numberFormat.NATIONAL
    );
    inputRef.current.value = formatted;
    -onPhoneChange(iti.getNumber());
  };

  inputEl.addEventListener("input", formatInput);

  return () => {
    inputEl.removeEventListener("input", formatInput);
    iti.destroy();
  };
}

/**
 * Valida e retorna E.164 de telefone brasileiro.
 * @param {string} value
 * @returns {{ valid: boolean, reason?: string, e164?: string }}
 */
export function validatePhoneBR(value) {
  const phoneNumber = parsePhoneNumberFromString(value, "BR");
  if (!phoneNumber) {
    return { valid: false, reason: "Formato de telefone inv√°lido" };
  }
  if (!phoneNumber.isValid()) {
    return { valid: false, reason: "Telefone inv√°lido para o Brasil" };
  }
  return { valid: true, e164: phoneNumber.number };
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CheckoutLayout/utils/emailUtils.js ====
// src/utils/emailUtils.js
// Sintaxe + blacklist de dom√≠nios descart√°veis e suspeitos

import validator from "validator";
import disposableDomains from "disposable-email-domains";

const extraBlacklist = [
  "scammer.com",
  "spamdomain.io",
  "fraud.net",
  // adicione aqui outros dom√≠nios de golpistas
];

const blacklist = new Set([...disposableDomains, ...extraBlacklist]);

/**
 * Valida sintaxe e bloqueia dom√≠nios indesejados.
 * @param {string} email
 * @returns {{ valid: boolean, reason?: string }}
 */
export function validateEmail(email) {
  if (!validator.isEmail(email)) {
    return { valid: false, reason: "Formato de e-mail inv√°lido" };
  }
  const domain = email.split("@")[1].toLowerCase();
  if (blacklist.has(domain)) {
    return { valid: false, reason: "Dom√≠nio de e-mail n√£o permitido" };
  }
  return { valid: true };
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/components/CheckoutLayout/utils/cepUtils.js ====
// src/utils/cepUtils.js

/**
 * Busca endere√ßo a partir do CEP usando a API ViaCEP.
 * @param {string} cep - CEP com 8 d√≠gitos (ex: "01001000")
 * @returns {Promise<{street: string, neighborhood: string, city: string, state: string}>}
 */
export async function fetchAddressByCEP(cep) {
  const sanitized = cep.replace(/\D/g, "");
  if (sanitized.length !== 8) {
    throw new Error("CEP deve ter 8 d√≠gitos.");
  }
  const res = await fetch(`https://viacep.com.br/ws/${sanitized}/json/`);
  if (!res.ok) {
    throw new Error("Erro ao buscar CEP.");
  }
  const data = await res.json();
  if (data.erro) {
    throw new Error("CEP n√£o encontrado.");
  }
  return {
    street: data.logradouro,
    neighborhood: data.bairro,
    city: data.localidade,
    state: data.uf,
  };
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/hooks/useProducts.js ====
import { useRef, useCallback, useEffect } from "react";
import useSWRInfinite from "swr/infinite";
import { fetcher } from "@/lib/fetcher";

const PAGE_SIZE = 12;
const apiUrl = process.env.NEXT_PUBLIC_API_URL;

export default function useProducts(selectedCategory) {
  const getKey = (pageIndex, previousPage) => {
    if (!selectedCategory) return null;
    if (previousPage && previousPage.data.length < PAGE_SIZE) return null;
    return (
      `${apiUrl}/api/produtos?populate=*&` +
      `filters[categoria][nome][$eq]=${encodeURIComponent(selectedCategory)}` +
      `&sort=id:asc&pagination[page]=${pageIndex + 1}` +
      `&pagination[pageSize]=${PAGE_SIZE}`
    );
  };

  const { data, size, setSize, isValidating, error } = useSWRInfinite(
    getKey,
    fetcher
  );

  const products = data
    ? data.flatMap((page) =>
        page.data.map((p) => ({
          id: p.id,
          title: p.title,
          imageUrl: p.image?.url
            ? `${apiUrl}${p.image.url}`
            : p.image?.formats?.medium?.url
              ? `${apiUrl}${p.image.formats.medium.url}`
              : "",
          variants: p.variants.map((v) => ({
            sku: v.sku,
            material: v.material,
            price: v.price,
          })),
        }))
      )
    : [];

  const isReachingEnd = data && data[data.length - 1].data.length < PAGE_SIZE;

  const observer = useRef();
  const lastRef = useCallback(
    (node) => {
      if (isValidating || isReachingEnd) return;
      if (observer.current) observer.current.disconnect();
      observer.current = new IntersectionObserver((entries) => {
        if (entries[0].isIntersecting) {
          setSize(size + 1);
        }
      });
      if (node) observer.current.observe(node);
    },
    [isValidating, isReachingEnd, size, setSize]
  );

  useEffect(() => {
    if (selectedCategory) setSize(1);
  }, [selectedCategory]);

  return {
    products,
    lastRef,
    isValidating,
    isReachingEnd,
    error,
  };
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/hooks/useCategories.js ====
import { useState, useEffect } from "react";

const apiUrl = process.env.NEXT_PUBLIC_API_URL;

export default function useCategories(pageSize = 100) {
  const [categories, setCategories] = useState([]);
  const [selectedCategory, setSelectedCategory] = useState("");
  const [error, setError] = useState(null);

  useEffect(() => {
    if (!apiUrl) {
      const msg = "‚ùå NEXT_PUBLIC_API_URL n√£o est√° definida";
      console.error(msg);
      setError(msg);
      return;
    }

    const url = `${apiUrl}/api/categorias?pagination[pageSize]=${pageSize}&sort=id:asc`;
    console.log("üîç Fetching categorias from:", url);

    fetch(url)
      .then((res) => {
        if (!res.ok) {
          throw new Error(`Erro HTTP ${res.status}`);
        }
        return res.json();
      })
      .then((j) => {
        const cats = j.data.map((c) => c.nome);
        setCategories(cats);
        if (cats.length > 0) setSelectedCategory(cats[0]);
        setError(null);
      })
      .catch((e) => {
        console.error("‚ùå Erro ao buscar categorias:", e);
        setError(e.message || "Erro desconhecido");
      });
  }, [pageSize]);

  return { categories, selectedCategory, setSelectedCategory, error };
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/hooks/useNotifications.js ====
// src/hooks/useNotifications.js
"use client";

import { useState, useCallback } from "react";

export function useNotifications(max = 7) {
  const [list, setList] = useState([]);

  const add = useCallback(
    (text) => {
      setList((prev) => {
        const newNotification = {
          // gera um UUID nativo (fallback para timestamp+random se n√£o suportado)
          id:
            typeof crypto !== "undefined" && crypto.randomUUID
              ? crypto.randomUUID()
              : `${Date.now()}-${Math.random()}`,
          text,
        };
        return [...prev, newNotification].slice(-max);
      });
    },
    [max]
  );

  const clear = useCallback(() => setList([]), []);

  return { list, add, clear };
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/lib/fetcher.js ====
export const fetcher = (url) => fetch(url).then((res) => res.json());
==== /home/ikemh/projetos/my-ecommerce/frontend/src/context/CartContext.jsx ====
// src/context/CartContext.jsx
"use client";
import React, { createContext, useReducer, useContext, useEffect } from "react";

const CartContext = createContext();

const initialState = { items: [] };

function cartReducer(state, action) {
  switch (action.type) {
    case "INIT":
      return action.payload;
    case "ADD_ITEM": {
      const { sku, quantity, ...rest } = action.payload;
      const exists = state.items.find((item) => item.sku === sku);
      if (exists) {
        return {
          items: state.items.map((item) =>
            item.sku === sku
              ? { ...item, quantity: item.quantity + quantity }
              : item
          ),
        };
      }
      return { items: [...state.items, { sku, quantity, ...rest }] };
    }
    case "REMOVE_ITEM":
      return {
        items: state.items.filter((item) => item.sku !== action.payload.sku),
      };
    case "CLEAR_CART":
      return { items: [] };
    default:
      return state;
  }
}

export function CartProvider({ children }) {
  const [state, dispatch] = useReducer(cartReducer, initialState);

  // inicializa do localStorage
  useEffect(() => {
    const stored = localStorage.getItem("cart");
    if (stored) dispatch({ type: "INIT", payload: JSON.parse(stored) });
  }, []);

  // persiste no localStorage
  useEffect(() => {
    localStorage.setItem("cart", JSON.stringify(state));
  }, [state]);

  const addItem = (item) => dispatch({ type: "ADD_ITEM", payload: item });
  const removeItem = (sku) =>
    dispatch({ type: "REMOVE_ITEM", payload: { sku } });
  const clearCart = () => dispatch({ type: "CLEAR_CART" });

  return (
    <CartContext.Provider
      value={{ items: state.items, addItem, removeItem, clearCart }}
    >
      {children}
    </CartContext.Provider>
  );
}

export function useCart() {
  return useContext(CartContext);
}
==== /home/ikemh/projetos/my-ecommerce/frontend/src/context/NotificationsContext.jsx ====
// src/context/NotificationsContext.jsx
"use client";

import React, { createContext, useContext, useState } from "react";

const NotificationsContext = createContext();

export function NotificationsProvider({ children }) {
  const [notifications, setNotifications] = useState([]);

  const addNotification = (text) =>
    setNotifications((prev) => [...prev, { id: Date.now(), text }]);

  const clearNotifications = () => setNotifications([]);

  return (
    <NotificationsContext.Provider
      value={{ notifications, addNotification, clearNotifications }}
    >
      {children}
    </NotificationsContext.Provider>
  );
}

export const useNotifications = () => useContext(NotificationsContext);
